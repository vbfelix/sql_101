<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>sql_101</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="003_sql_001_outros_comandos_files/libs/clipboard/clipboard.min.js"></script>
<script src="003_sql_001_outros_comandos_files/libs/quarto-html/quarto.js"></script>
<script src="003_sql_001_outros_comandos_files/libs/quarto-html/popper.min.js"></script>
<script src="003_sql_001_outros_comandos_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="003_sql_001_outros_comandos_files/libs/quarto-html/anchor.min.js"></script>
<link href="003_sql_001_outros_comandos_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="003_sql_001_outros_comandos_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="003_sql_001_outros_comandos_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="003_sql_001_outros_comandos_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="003_sql_001_outros_comandos_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#join" id="toc-join" class="nav-link active" data-scroll-target="#join">JOIN</a>
  <ul class="collapse">
  <li><a href="#descrição" id="toc-descrição" class="nav-link" data-scroll-target="#descrição">Descrição</a></li>
  <li><a href="#sintaxeexemplo" id="toc-sintaxeexemplo" class="nav-link" data-scroll-target="#sintaxeexemplo">Sintaxe/exemplo</a></li>
  <li><a href="#left-join" id="toc-left-join" class="nav-link" data-scroll-target="#left-join">LEFT JOIN</a>
  <ul class="collapse">
  <li><a href="#descrição-1" id="toc-descrição-1" class="nav-link" data-scroll-target="#descrição-1">Descrição</a></li>
  <li><a href="#sintaxeexemplo-1" id="toc-sintaxeexemplo-1" class="nav-link" data-scroll-target="#sintaxeexemplo-1">Sintaxe/exemplo</a></li>
  </ul></li>
  <li><a href="#right-join" id="toc-right-join" class="nav-link" data-scroll-target="#right-join">RIGHT JOIN</a>
  <ul class="collapse">
  <li><a href="#descrição-2" id="toc-descrição-2" class="nav-link" data-scroll-target="#descrição-2">Descrição</a></li>
  <li><a href="#sintaxeexemplo-2" id="toc-sintaxeexemplo-2" class="nav-link" data-scroll-target="#sintaxeexemplo-2">Sintaxe/exemplo</a></li>
  </ul></li>
  <li><a href="#inner-join" id="toc-inner-join" class="nav-link" data-scroll-target="#inner-join">INNER JOIN</a>
  <ul class="collapse">
  <li><a href="#descrição-3" id="toc-descrição-3" class="nav-link" data-scroll-target="#descrição-3">Descrição</a></li>
  </ul></li>
  <li><a href="#full-join" id="toc-full-join" class="nav-link" data-scroll-target="#full-join">FULL JOIN</a>
  <ul class="collapse">
  <li><a href="#descrição-4" id="toc-descrição-4" class="nav-link" data-scroll-target="#descrição-4">Descrição</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#union" id="toc-union" class="nav-link" data-scroll-target="#union">UNION</a>
  <ul class="collapse">
  <li><a href="#descrição-5" id="toc-descrição-5" class="nav-link" data-scroll-target="#descrição-5">Descrição</a></li>
  <li><a href="#sintaxeexemplo-3" id="toc-sintaxeexemplo-3" class="nav-link" data-scroll-target="#sintaxeexemplo-3">Sintaxe/exemplo</a></li>
  </ul></li>
  <li><a href="#subquerysub-consulta" id="toc-subquerysub-consulta" class="nav-link" data-scroll-target="#subquerysub-consulta"><em>Subquery</em>/Sub-consulta</a>
  <ul class="collapse">
  <li><a href="#descrição-6" id="toc-descrição-6" class="nav-link" data-scroll-target="#descrição-6">Descrição</a></li>
  <li><a href="#sintaxeexemplo-4" id="toc-sintaxeexemplo-4" class="nav-link" data-scroll-target="#sintaxeexemplo-4">Sintaxe/exemplo</a></li>
  </ul></li>
  <li><a href="#funções-condicionais" id="toc-funções-condicionais" class="nav-link" data-scroll-target="#funções-condicionais">Funções condicionais</a>
  <ul class="collapse">
  <li><a href="#case_when" id="toc-case_when" class="nav-link" data-scroll-target="#case_when">CASE_WHEN</a>
  <ul class="collapse">
  <li><a href="#descrição-7" id="toc-descrição-7" class="nav-link" data-scroll-target="#descrição-7">Descrição</a></li>
  <li><a href="#sintaxeexemplo-5" id="toc-sintaxeexemplo-5" class="nav-link" data-scroll-target="#sintaxeexemplo-5">Sintaxe/Exemplo</a></li>
  </ul></li>
  <li><a href="#coalesce" id="toc-coalesce" class="nav-link" data-scroll-target="#coalesce">COALESCE</a>
  <ul class="collapse">
  <li><a href="#descrição-8" id="toc-descrição-8" class="nav-link" data-scroll-target="#descrição-8">Descrição</a></li>
  <li><a href="#sintaxeexemplo-6" id="toc-sintaxeexemplo-6" class="nav-link" data-scroll-target="#sintaxeexemplo-6">Sintaxe/Exemplo</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">sql_101</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="join" class="level1">
<h1>JOIN</h1>
<section id="descrição" class="level2">
<h2 class="anchored" data-anchor-id="descrição">Descrição</h2>
<p>Os comandos de <code>JOIN</code> servem para unir tabelas a partir de uma relação de campos, em que cada tipo de join preservará os registros a partir de uma condição de uma ou de ambas as tabelas.</p>
<p><img src="images/paste-A402040E.png" class="img-fluid"></p>
</section>
<section id="sintaxeexemplo" class="level2">
<h2 class="anchored" data-anchor-id="sintaxeexemplo">Sintaxe/exemplo</h2>
<p>Para usar o <code>JOIN</code> usamos da seguinte sintaxe:</p>
<p>(tipo de SQL) + <code>JOIN</code> + (tabela a ser juntada) + <code>ON</code> + (equivalência de chaves)</p>
</section>
<section id="left-join" class="level2">
<h2 class="anchored" data-anchor-id="left-join">LEFT JOIN</h2>
<section id="descrição-1" class="level3">
<h3 class="anchored" data-anchor-id="descrição-1">Descrição</h3>
<p>O comando <code>LEFT JOIN</code> é usado para combinar linhas de duas tabelas com base em uma coluna comum, incluindo todas as linhas da tabela esquerda e apenas as linhas correspondentes da tabela direita.</p>
</section>
<section id="sintaxeexemplo-1" class="level3">
<h3 class="anchored" data-anchor-id="sintaxeexemplo-1">Sintaxe/exemplo</h3>
<p>​Vamos adicionar o nome da raça na tabela animais, para tal vamos identificar primeiro quais as chaves de cada tabela.</p>
<pre><code>SELECT 
    racas_id AS raca_id,
    r.nome AS raca_nome
FROM animais a 
LEFT JOIN racas r ON a.racas_id = r.id
;</code></pre>
<p>No exemplo acima, fazemos a junção das tabelas <code>animais</code> e <code>racas</code> com seus respectivos <em>alias</em> <code>a</code> e <code>r</code>, em que equivalemos os campo <code>a.racas_id</code> (chave estrangeira) a <code>r.id</code> (chave primária)</p>
</section>
</section>
<section id="right-join" class="level2">
<h2 class="anchored" data-anchor-id="right-join">RIGHT JOIN</h2>
<section id="descrição-2" class="level3">
<h3 class="anchored" data-anchor-id="descrição-2">Descrição</h3>
<p>O comando <code>RIGHT JOIN</code> é usado para combinar linhas de duas tabelas com base em uma coluna comum, incluindo todas as linhas da tabela direira e apenas as linhas correspondentes da tabela esquerda.</p>
</section>
<section id="sintaxeexemplo-2" class="level3">
<h3 class="anchored" data-anchor-id="sintaxeexemplo-2">Sintaxe/exemplo</h3>
<p>Não é tão usado, pois pode gerar o mesmo resultado do <code>LEFT JOIN</code>, vamos replicar o exemplo anterior:</p>
<pre><code>SELECT 
    racas_id AS raca_id,
    r.nome AS raca_nome
FROM racas r 
RIGHT JOIN animais a ON a.racas_id = r.id
;</code></pre>
</section>
</section>
<section id="inner-join" class="level2">
<h2 class="anchored" data-anchor-id="inner-join">INNER JOIN</h2>
<section id="descrição-3" class="level3">
<h3 class="anchored" data-anchor-id="descrição-3">Descrição</h3>
<p>O comando <code>INNER JOIN</code> é usado para combinar linhas de duas tabelas com base em uma coluna comum, incluindo todas as linhas em comum das duas tabelas.</p>
</section>
</section>
<section id="full-join" class="level2">
<h2 class="anchored" data-anchor-id="full-join">FULL JOIN</h2>
<section id="descrição-4" class="level3">
<h3 class="anchored" data-anchor-id="descrição-4">Descrição</h3>
<p>O comando <code>FULL JOIN</code> é usado para combinar linhas de duas tabelas com base em uma coluna comum, incluindo todas as linhas em das duas tabelas, independente se existir vínculo entre as tabelas, em que os campos sem vínculo ficarão nulos.</p>
</section>
</section>
</section>
<section id="union" class="level1">
<h1>UNION</h1>
<section id="descrição-5" class="level2">
<h2 class="anchored" data-anchor-id="descrição-5">Descrição</h2>
<p>O comando <code>UNION</code> é usado para combinar os resultados de duas ou mais consultas <code>SELECT</code> em uma única tabela resultante.</p>
<p>O comando <code>UNION</code> remove linhas duplicadas do resultado final, a menos que a palavra-chave <code>ALL</code> seja usada.</p>
</section>
<section id="sintaxeexemplo-3" class="level2">
<h2 class="anchored" data-anchor-id="sintaxeexemplo-3">Sintaxe/exemplo</h2>
<p>Vamos selecionar os animais que passaram por uma aplicação sanitária ou que foram movimentados.</p>
<pre><code>SELECT va.animal_id, 'sanidade' AS tipo
FROM vacinacao_animais va -- Tabela de aplicações sanitárias
UNION -- Empilha os dados
SELECT DISTINCT(am.animal_id), 'movimentação' AS tipo
FROM animais_movimentacoes am -- Tabela de animais movimentados
;</code></pre>
</section>
</section>
<section id="subquerysub-consulta" class="level1">
<h1><em>Subquery</em>/Sub-consulta</h1>
<section id="descrição-6" class="level2">
<h2 class="anchored" data-anchor-id="descrição-6">Descrição</h2>
<p>É uma consulta aninhada dentro de outra consulta. Ela pode ser utilizada no <code>SELECT</code>, <code>FROM</code> ou <code>WHERE</code>.</p>
</section>
<section id="sintaxeexemplo-4" class="level2">
<h2 class="anchored" data-anchor-id="sintaxeexemplo-4">Sintaxe/exemplo</h2>
<p>Vamos calcular a quantidade de animais por status, o total e a porcentagem por status</p>
<pre><code>SELECT 
    a.status,
    COUNT(*) as animais_status,
    (SELECT COUNT(*) FROM animais) AS total,
    100*COUNT(*)/(SELECT COUNT(*) FROM animais) AS perc
FROM animais a 
GROUP BY a.status</code></pre>
</section>
</section>
<section id="funções-condicionais" class="level1">
<h1>Funções condicionais</h1>
<section id="case_when" class="level2">
<h2 class="anchored" data-anchor-id="case_when">CASE_WHEN</h2>
<section id="descrição-7" class="level3">
<h3 class="anchored" data-anchor-id="descrição-7">Descrição</h3>
<p>O comando <code>CASE_WHEN</code> é uma forma de criar expressões condicionais em uma consulta, permitindo que você especifique uma série de condições e retorne um valor diferente para cada condição.</p>
</section>
<section id="sintaxeexemplo-5" class="level3">
<h3 class="anchored" data-anchor-id="sintaxeexemplo-5">Sintaxe/Exemplo</h3>
<pre><code>SELECT 
  CASE
    WHEN dt_nascimento IS NULL THEN dt_register
    ELSE dt_nascimento 
  END   AS dt_nasc
FROM animais
WHERE dt_nascimento IS NULL
;</code></pre>
<p>No exemplo acima quando o campo <code>dt_nascimento</code> é nulo o valor retornado é o do campo <code>dt_register</code>, caso contrário mantém-se a o valor do campo <code>dt_nascimento</code>.</p>
<p>Neste caso só existem dois cenários, porém podemos colocar quantos cenários e condições quisermos.</p>
</section>
</section>
<section id="coalesce" class="level2">
<h2 class="anchored" data-anchor-id="coalesce">COALESCE</h2>
<section id="descrição-8" class="level3">
<h3 class="anchored" data-anchor-id="descrição-8">Descrição</h3>
<p>O comando <code>COALESCE</code> pode ser visto como uma caso específico do <code>CASE_WHEN</code>, em que a condição a ser avaliada é a de valor nulo, logo podemos replicar o exemplo anterior com ela.</p>
</section>
<section id="sintaxeexemplo-6" class="level3">
<h3 class="anchored" data-anchor-id="sintaxeexemplo-6">Sintaxe/Exemplo</h3>
<pre><code>SELECT 
  COALESCE(dt_nascimento,dt_register) AS dt_nasc
FROM animais
WHERE dt_nascimento IS NULL
;</code></pre>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>